<!doctype html><html><meta http-equiv=content-type content="text/html" charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>OpenVAS</title><link rel="shortcut icon" href=https://schmid7k.github.io/s-for-security/images/favicon.png type=image/png><meta name=description content="Tips, tricks and write ups for Capture the Flag challenges."><meta name=keywords content="writeups,penetration-testing,cybersecurity,tryhackme,hackthebox"><meta name=referrer content="no-referrer-when-downgrade"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://schmid7k.github.io/s-for-security/css/screen.css><link rel=stylesheet href=https://schmid7k.github.io/s-for-security/css/fonts.css type=text/css><link rel=stylesheet href=https://schmid7k.github.io/s-for-security/fork-awesome/css/fork-awesome.min.css type=text/css><meta property="og:title" content="OpenVAS"><meta property="og:description" content="This write up refers to the OpenVAS room on TryHackMe.
In this room we are familiarizing ourselves with the OpenVAS vulnerability scanner.
Task 1: Introduction The official documentation states:
OpenVAS is an application used to scan endpoints and web applications to identify and detect vulnerabilities. It is commonly used by corporations as part of their mitigation solutions to quickly identify any gaps in their production or even development servers or applications."><meta property="og:type" content="article"><meta property="og:url" content="https://schmid7k.github.io/s-for-security/posts/tryhackme/cyber_defense/openvas/"><meta property="og:image" content="https://schmid7k.github.io/s-for-security/images/cover-image.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-09T19:23:33+01:00"><meta property="article:modified_time" content="2022-03-09T19:23:33+01:00"><meta property="og:site_name" content="S for Security"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://schmid7k.github.io/s-for-security/images/cover-image.jpg"><meta name=twitter:title content="OpenVAS"><meta name=twitter:description content="This write up refers to the OpenVAS room on TryHackMe.
In this room we are familiarizing ourselves with the OpenVAS vulnerability scanner.
Task 1: Introduction The official documentation states:
OpenVAS is an application used to scan endpoints and web applications to identify and detect vulnerabilities. It is commonly used by corporations as part of their mitigation solutions to quickly identify any gaps in their production or even development servers or applications."><meta itemprop=name content="OpenVAS"><meta itemprop=description content="This write up refers to the OpenVAS room on TryHackMe.
In this room we are familiarizing ourselves with the OpenVAS vulnerability scanner.
Task 1: Introduction The official documentation states:
OpenVAS is an application used to scan endpoints and web applications to identify and detect vulnerabilities. It is commonly used by corporations as part of their mitigation solutions to quickly identify any gaps in their production or even development servers or applications."><meta itemprop=datePublished content="2022-03-09T19:23:33+01:00"><meta itemprop=dateModified content="2022-03-09T19:23:33+01:00"><meta itemprop=wordCount content="1065"><meta itemprop=image content="https://schmid7k.github.io/s-for-security/images/cover-image.jpg"><meta itemprop=keywords content><body><main class="content page-template page-" role=main><article class="post page"><header class=post-header><a id=blog-logo href=/s-for-security/>S for Security</a></header><h1 class=post-title>OpenVAS</h1><section class=post-content><p>This write up refers to the <a href=https://tryhackme.com/room/openvas>OpenVAS</a> room on <a href=https://tryhackme.com/>TryHackMe</a>.</p><p>In this room we are familiarizing ourselves with the <a href=https://openvas.org/>OpenVAS</a> vulnerability scanner.</p><h4 id=task-1-introduction>Task 1: Introduction</h4><p>The official documentation states:<br><em>OpenVAS is an application used to scan endpoints and web applications to identify and detect vulnerabilities. It is commonly used by corporations as part of their mitigation solutions to quickly identify any gaps in their production or even development servers or applications. This is not an end all be all solution but can help to get rid of any common vulnerabilities that may have slipped through the cracks.</em></p><h5 id=question-1>Question 1)</h5><p>Read the introductory text and click the <code>Completed</code> button.</p><h4 id=task-2-gvm-framework-architecture>Task 2: GVM Framework Architecture</h4><p>This task talks about the structure of the <em>Greenbone Vulnerability Management (GVM)</em> framework and how OpenVAS fits into it.</p><p><img src=../../../../images/content/tryhackme/cyber_defense/openvas/GVM_breakdown.png alt="GVM structure" title="GVM structure"></p><p>The GVM framework can be broken down into distinct sub-section: Front-End, Back-End, and Vulnerability/Information feed. Each part has different obligations.</p><p><strong>Front-End (GSA, Web Interfaces)</strong><br>The front-end provides you with an accessible GUI via the web interface you can navigate to in your browser.</p><p><strong>Back-End (OSP, OpenVAS, Targets)</strong><br>The back-end infrastructure conducts the actual vulnerability scans and data processing through OpenVAS and GVM. The <em>Greenbone Vulnerability Manager</em> acts like a middle man between scanners and the front-end user interface</p><p><strong>Vulnerability/Information Feed (NVT, SCAP CERT, User Data, Community Feed)</strong><br>This part of GVM contains information and vulnerability tests provided by that <em>Greenbone Community Feed</em>, which is the baseline for testing against systems. Here you may also provide user data in place of <em>NVTs</em> and <em>SCAP CERTs</em>.</p><h5 id=question-2>Question 2)</h5><p>Read about GVM architecture and click the <code>Completed</code> button.</p><h4 id=task-3-installing-openvas>Task 3: Installing OpenVAS</h4><p>The by far easiest way to install OpenVAS is through docker. Open a terminal and type in:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install docker.io
</span></span><span style=display:flex><span>sudo docker run -d -p 443:443 --name openvas mikesplain/openvas
</span></span></code></pre></div><p>and after a few minutes of installing and set up you should be able to navigate to <a href=https://127.0.0.1>https://127.0.0.1</a> in your browser and be greeted by OpenVAS&rsquo; login window.</p><p>Type in the default credentials <code>admin/admin</code> and you should see the dashboard.</p><h5 id=question-3>Question 3)</h5><p>Install and setup OpenVAS, then click the <code>Completed</code> button.</p><h4 id=task-4-initial-configuration>Task 4: Initial Configuration</h4><p>Make sure that OpenVAS is properly configured and ready to run by going to <em>Scans > Tasks</em>, click on the purple magic wand icon in the upper left corner and start the basic configuration wizard. Initiate a scan on <code>127.0.0.1</code> and wait until the scan finishes.</p><p><em>This task can take <strong>A LOT</strong> of time and your browser may not be responsible while the scan is running. Take a break, stretch, get some tea or coffee and wait until it finishes.</em></p><p>After it is done you should be taken to a new dashboard for analyzing your completed and ongoing scans. Now you should also be able to navigate to <em>Scans > Reports</em> and click on the newly created report about the scan on your localhost.</p><h5 id=question-4>Question 4)</h5><p>Complete the first scan and click the <code>Completed</code> button.</p><h4 id=task-5-scanning-infrastructure>Task 5: Scanning Infrastructure</h4><p>Now the real fun begins. Deploy the virtual machine attached to this task and make sure you are connected to the TryHackMe network via OpenVPN or the AttackBox.</p><p>Click on the star icon in the upper left corner of the <em>Scans</em> dashboard to open the <em>New Task</em> window. Here you can create and modify settings for a new OpenVAS task. Begin by giving it a recognizable name.</p><p>Now you want to configure a new target by clicking the star icon next to the <em>Scan Targets</em> option. Give your target a name and set the IP address under the <em>Hosts</em> option to the address of the target VM. You can safely ignore all other options, they are only used for advanced vulnerability management solutions.</p><p>When you are done configuring the target finish task creation and you are brought back to the <em>Scans</em> dashboard with the newly created task in the list of tasks.</p><h5 id=question-5>Question 5)</h5><p>Start the newly created scan by clicking the green arrow icon below the <em>Actions</em> tab and click the <code>Completed</code> button.</p><h4 id=task-6-reporting-and-continuous-monitoring>Task 6: Reporting and Continuous Monitoring</h4><p>Now we familiarize ourselves with OpenVAS&rsquo; reporting and monitoring capabilities. Download the report attached to the task and open it in your browser.</p><p>The report begins with some general information on when the scan was started, when it ended, the name of the task that ran, as well as some host specific information such as target IPs, how many vulnerabilities were found and how severe they were.</p><p>Afterwards OpenVAS goes into detail about every vulnerability. How it was detected, why it was detected and how to mitigate it.</p><h5 id=question-6>Question 6)</h5><p>Read through the task description on how to read OpenVAS reports and practice reporting and monitoring. Click the <code>Completed</code> button to finish the task.</p><h4 id=task-7-practical-vulnerability-management>Task 7: Practical Vulnerability Management</h4><p>Challenge time! Download the report attached to the task and open it in your browser.</p><h5 id=question-7-when-did-the-scan-start-in-case-001>Question 7) When did the scan start in Case 001?</h5><p>Look at the <em>Start</em> tab in the <em>Host Summary</em> table.</p><p><strong>Solution:</strong> Feb 28, 00:04:46</p><h5 id=question-8-when-did-the-scan-end-in-case-001>Question 8) When did the scan end in Case 001?</h5><p>Look at the <em>End</em> tab in the <em>Host Summary</em> table.</p><p><strong>Solution:</strong> Feb 28, 00:21:02</p><h5 id=question-9-how-many-ports-are-open-in-case-001>Question 9) How many ports are open in Case 001?</h5><p>Look at the <em>Port Summary</em> table. (Hint: <em>general/tcp</em> is not a port)</p><p><strong>Solution:</strong> 3</p><h5 id=question-10-how-many-vulnerabilities-were-found-in-case-001>Question 10) How many vulnerabilities were found in Case 001?</h5><p>Look at the <em>High</em>, <em>Medium</em>, and <em>Low</em> tabs in the <em>Host Summary</em> table.</p><p><strong>Solution:</strong> 5</p><h5 id=question-11-what-is-the-highest-severity-vulnerability-found-msxx-xxx>Question 11) What is the highest severity vulnerability found? (MSxx-xxx)</h5><p>OpenVAS presents vulnerabilities in its reports sorted from highest to lowest severity. Therefore the highest severity vulnerability should be at the very top of the <em>Security Issues</em> section.</p><p><strong>Solution:</strong> MS17-010</p><h5 id=question-12-what-is-the-first-affected-os-to-this-vulnerability>Question 12) What is the first affected OS to this vulnerability?</h5><p>Information on affected OS&rsquo; can be found below the <em>Affected Software/OS</em> tab.</p><p><strong>Solution:</strong> Microsoft Windows 10 x32/x64 Edition</p><h5 id=question-13-what-is-the-recommended-vulnerability-detection-method>Question 13) What is the recommended vulnerability detection method?</h5><p>Information on how the vulnerability was detected can be found below the <em>Vulnerability Detection Method</em> tab.</p><p><strong>Solution:</strong> Send the crafted SMB transaction request with fid = 0 and check the response to confirm the vulnerability.</p><h4 id=task-8-conclusion>Task 8: Conclusion</h4><p>Congratulations, you finished the <a href=https://tryhackme.com/room/openvas>OpenVAS</a> room on <a href=https://tryhackme.com/>TryHackMe</a>!</p><p>If you want to learn more about OpenVAS and GVM take a look at the technical <a href=https://docs.greenbone.net/>documentation</a> or head over to the <a href=https://community.greenbone.net/>community portal</a>.</p><h5 id=question-14>Question 14)</h5><p>Click on the <code>Completed</code> button to finish the room.</p></section></article></main><footer class=site-footer><div class=inner><section class=copyright>©Schmid7k</section><section></section><section><a href=https://themes.gohugo.io/hugo-scroll/>Design</a> template
built with ♥️ by
<a href=https://www.janraasch.com title="Jan Raasch">Jan Raasch</a></section></div></footer><script type=text/javascript src=https://schmid7k.github.io/s-for-security/js/jquery-1.11.3.min.js></script>
<script type=text/javascript src=https://schmid7k.github.io/s-for-security/js/icons.js></script>
<script type=text/javascript src=https://schmid7k.github.io/s-for-security/js/index.js></script></body></html>